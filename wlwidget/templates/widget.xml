<Module>
 <ModulePrefs title="Hello World!">
 <Require feature="opensocial-0.8" />
 <Require feature="osapi" />
 </ModulePrefs>
 <Content type="html" view="canvas">
 <![CDATA[
<script type="text/javaScript">

    function populateIFrame() {
        alert("Populating iframe");
        var ifr = document.getElementById('weblabIFrame');
        alert(ifr.contentWindow.document.body);
    }

    function init() {
       var token = shindig.auth.getSecurityToken();
       var srcString = '{{ url_for('main', _external=True) }}?st=' + token;
       document.getElementById('container').innerHTML = '<iframe id="weblabIFrame" frameborder="0" onload="populateIFrame()" width="710" height="650" src="'+srcString+'"></iframe>';
       gadgets.window.adjustHeight(); //so app resizes itself based on content
    }

    gadgets.util.registerOnLoadHandler(init);
</script>
 <div id="container">
 </div>
 ]]>
</Content>
</Module>
